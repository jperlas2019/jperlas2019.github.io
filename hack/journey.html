<style>
    html *
    {
        font-family:Arial;
        color: white
    }

    body {
        background-color: black;
    }

    div {
        width: 600px
    }
</style>


<h1>Jaguar's Hacking Journey</h1>
<h2>A blog of my hacking career.</h2>

</br>
<div>
<h3>Nibbles</h3>
<h4>August 07, 2022</h4>
<p>
    My first box to exploit. Although it was guided and an easy rated box, it made me realize that there is a lot to learn when it comes to hacking.
    Even with a strong fundamental background and experience in IT, hacking requires knowledge about almost every technology. If not, then it requires
    the ability to learn quickly and adapt. Don't know something? Google it, learn it, get the hang of it quickly, and move on. To be honest, I would've
    had difficulty if I were to tackle this on my own.
</p>
<p>
    The main attack vector is through a vulnerable web application called Nibbleblog. Below, I will tell you how I hacked this box.
</p>
<p>
    With our given IP address, 10.129.200.170, I first start off with <b>nmap</b> to gain information about the box's open ports. I used the command 
    <b>nmap 10.129.200.170 -sV</b> to quickly scan common ports and the version of what is running behind it. We get these results:
    <img src="images/nibblesnmap.jpg">
</p>
<p>
    We see that port 22, SSH port used for accessing a computer remotely, and port 80, HTTP port that allows us to visit websites. Since port 80 is open,
    we can type the IP address in a browser and see what kind of content the server is hosting. Going to this IP address, we are greeted with nothing special.
    <img src="images/nibbleshelloworld.jpg">
</p>
<p>
    If we look at the page source, we gain one piece of valuable information:
    <img src="images/nibblespagesource.jpg">
</p>
<p>
    "/nibbleblog/ directory"... This tells us there's more to this website. By typing <b>http://10.129.200.170/nibbleblog/</b> in our browser, we are directed
    to the actual blog of the server.
    <img src="images/nibblesblog.jpg">
</p>
<p>
    Exploring the website, there isn't much information on it. But because there is a directory /nibbleblog/, there could be more pages hidden within the 
    server. To quickly brute-force common directory names of a web server, I used <b>Gobuster</b> to find more directories automatically and quickly. I 
    used the command <b>gobuster -u 10.129.200.170 -w /usr/share/dirb/wordlists/common.txt</b>. We've found the following pages:
    <img src="images/nibblespages.jpg">
</p>
<p>
    Interestingly, there is an <b>admin.php</b> file. Going to <b>http://10.129.200.170/nibbleblog/admin.php</b> takes us to an admin login page.
    <img src="images/nibbleslogin.jpg">
</p>
<p>
    I can't help myself but try common default credentials, such as admin/admin, admin/[blank], root/[blank], etc.
    They didn't work, so I needed to find more information to give us an idea of what the credentials could be. I explored the other directories that we've found 
    in our gobuster results. Luckily this web server makes it easy for us to navigate through directories. We've found an interesting folder named <b>private</b>.
    <img src="images/nibblescontent.jpg">
</p>
<p>
    We found a file called <b>config.xml</b>, and <b>users.xml</b>. Both files bring valuable information, as <b>users.xml</b> confirms the username of the admin user 
    and <b>config.xml</b> giving us a hint of what the password could be. Below in order are <b>users.xml</b> and <b>config.xml</b>
    <img src="images/nibblesusers.jpg">
<p></p>
    <img src="images/nibblesconfig.jpg">
</p>
<p>
    We now know that the username is <b>admin</b>. Could the password be <b>nibbles</b> ? Yes. We're logged in as admin.
    <img src="images/nibblesloggedin.jpg">
</p>
<p>
    Exploring through the admin page, we find that the version of the blog is using <b>Nibbleblog 4.0.3 "Coffee"</b>. A quick search shows that there is a vulnerability 
    that we can exploit. The vulnerability is that the uploading of images through the "My Image" plugin keeps the original extension of the uploaded file. This means that
    we can upload a PHP (cause the website is PHP) script and run it to potentially get a reverse shell.
    We can upload our script here:
    <img src="images/nibblesmyimage.jpg">
</p>
<p>
    This is the script we are uploading to get our reverse shell.
    <img src="images/nibblesscript.jpg">
</p>
<p>
    To confirm our script uploaded successfully, I explored and navigated to <b>http://10.129.200.170/nibbleblog/content/private/plugins/my_image</b> to find our file.
    Since we've uploaded an image using the <b>My Image</b> plugin, it is a good chance that <b>image.php</b> could be our script. 
    <img src="images/nibblesfilepath.jpg">
</p>
<p>
    To start our reverse shell, we need a listener on our attack machine. I used the command <b>nc -lvnp 4545</b> to allow my machine to listen for connections on port 4545.
    <img src="images/nibbleslistener.jpg">
</p>
<p>
    To run our uploaded script, I used the command <b>curl http://10.129.200.170/nibbleblog/content/private/plugins/my_image/image.php</b> to call our script, which runs it.
    On our listener, we've picked up a connection. We now have access to the web server machine as the user <b>nibbler</b>. 
    <img src="images/nibblesreverseshell.jpg">
</p>
<p>
    This is definitely great, we've hacked a machine. But we don't stop there. We want to hack the machine and <b>gain full privileges</b>. With the <b>nibbler</b> user,
    we do not have full admin privileges to do anything we desire with the machine. We need to <b>escalate our privileges</b>.
</p>
<p>
    After gaining a reverse shell and have access to a user on the target machine, I wanted to know what privileges I have currently. I use the command <b>sudo -l</b> to find out.
    Turns out, we can run a command as root (highest privileges) without entering a password.
    <img src="images/nibblessudol.jpg">
</p>
<p>
    Luckily, this file is a world-writable. And since we can run this file as root, we can append a reverse shell command to the end of the file, run as root, and gain access
    to target machine as root.
    <img src="images/nibbleswritable.jpg">
</p>
<p>
    Let's start a listener on our attack machine, just like last time but on a different port. 4546.
    <img src="images/nibbleslistener4546.jpg">
</p>
<p>
    We then append our reverse shell command to the end of the file.
    <img src="images/nibblesreverseshell2.jpg">
</p>
<p>
    Once we run the modified script using <b>sudo ./monitor.sh</b>, we have a connection on our listener.
    Using the <b>id</b> command to verify who we are, we can confirm that we are the root user.
    <img src="images/nibblesroot.jpg">
</p>
<p>
    We have successfully hacked the web server machine and gained root access. We can do whatever we want to this machine.
</p>
</div>
